<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title> 看我Blog文章导航会动哎！ - Grass </title>
    <link rel="stylesheet" href="/style.css">
    <style>
        #music {
            position: fixed;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
<div id="root">
    <div class="wrap" data-reactroot="" data-reactid="1" data-react-checksum="-731322847"><header data-reactid="2"><a class="logo-link" href="/" data-reactid="3"><img src="/favicon.png" data-reactid="4"/></a><ul class="nav nav-list" data-reactid="5"><li class="nav-list-item" data-reactid="6"><a class="nav-list-link" href="/posts/1" data-reactid="7">Posts</a></li></ul></header><main data-reactid="8"><div class="post" data-reactid="9"><article class="post-block" data-reactid="10"><h1 class="post-title" data-reactid="11">看我Blog文章导航会动哎！</h1><div class="post-info" data-reactid="12"><time datetime="2016-04-22T20:52:18+00:00" data-reactid="13">Apr 22, 2016 8:52 PM</time></div></article><div class="post-content" data-reactid="14"><article data-reactid="15"><style data-reactid="16">.transformer-react-render{border:1px dashed #959da5;border-radius:5px;display:block}.transformer-react-render-container&gt;pre{max-height:400px;transition:all .2s ease}.transformer-react-render-container&gt;pre.focused{max-height:none;box-shadow:0 0 6px rgba(0,0,0,.2)}</style><blockquote data-reactid="17"><p data-reactid="18">实现侧边内容的动态跳转，非锚点。 点击右侧的文章侧边导航栏，实现动态效果跳转。</p></blockquote><h1 id="怎么实现滴？" data-reactid="19"><a href="#%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E6%BB%B4%EF%BC%9F" aria-hidden="true" data-reactid="20"><span class="icon icon-link" data-reactid="21"></span></a><!-- react-text: 22 -->怎么实现滴？<!-- /react-text --></h1><p data-reactid="23"><!-- react-text: 24 -->找到hexo文件夹中你选择的主题文件夹，在我这是<!-- /react-text --><code data-reactid="25">themes/indigo</code><!-- react-text: 26 --> 进入<!-- /react-text --><code data-reactid="27">source/js</code><!-- react-text: 28 -->，修改js文件<!-- /react-text --></p><pre data-reactid="29"><code class="hljs language-javascript" data-query="{}" data-lang="javascript" data-reactid="30"><span class="hljs-comment" data-reactid="31">/*
 * d-&gt;document;
 * animate-&gt;requestAnimationFrame
 */</span><!-- react-text: 32 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="33">var</span><!-- react-text: 34 --> links = d.querySelectorAll(<!-- /react-text --><span class="hljs-string" data-reactid="35">&#x27;.post-toc-link&#x27;</span><!-- react-text: 36 -->);
<!-- /react-text --><span class="hljs-keyword" data-reactid="37">for</span><!-- react-text: 38 -->(<!-- /react-text --><span class="hljs-keyword" data-reactid="39">var</span><!-- react-text: 40 --> i = <!-- /react-text --><span class="hljs-number" data-reactid="41">0</span><!-- react-text: 42 -->;i &lt; links.length;i++){
	<!-- /react-text --><span class="hljs-keyword" data-reactid="43">var</span><!-- react-text: 44 --> link = links.item(i);
	link.addEventListener(<!-- /react-text --><span class="hljs-string" data-reactid="45">&#x27;click&#x27;</span><!-- react-text: 46 -->,<!-- /react-text --><span class="hljs-function" data-reactid="47"><span class="hljs-keyword" data-reactid="48">function</span><!-- react-text: 49 -->(<!-- /react-text --><span class="hljs-params" data-reactid="50">e</span><!-- react-text: 51 -->)<!-- /react-text --></span><!-- react-text: 52 -->{
		e.preventDefault();
		<!-- /react-text --><span class="hljs-keyword" data-reactid="53">var</span><!-- react-text: 54 --> id = <!-- /react-text --><span class="hljs-keyword" data-reactid="55">this</span><!-- react-text: 56 -->.hash;
		<!-- /react-text --><span class="hljs-keyword" data-reactid="57">var</span><!-- react-text: 58 --> tg = d.querySelector(id);
		<!-- /react-text --><span class="hljs-keyword" data-reactid="59">var</span><!-- react-text: 60 --> max = d.body.scrollHeight - d.body.offsetHeight,tg_parent_top = tg.offsetParent.offsetTop;
		<!-- /react-text --><span class="hljs-function" data-reactid="61"><span class="hljs-keyword" data-reactid="62">function</span><!-- react-text: 63 --> <!-- /react-text --><span class="hljs-title" data-reactid="64">scrollToLink</span><!-- react-text: 65 -->(<!-- /react-text --><span class="hljs-params" data-reactid="66"></span><!-- react-text: 67 -->)<!-- /react-text --></span><!-- react-text: 68 -->{
			<!-- /react-text --><span class="hljs-keyword" data-reactid="69">var</span><!-- react-text: 70 --> to = tg.offsetTop+tg_parent_top - <!-- /react-text --><span class="hljs-number" data-reactid="71">40</span><!-- react-text: 72 -->,
				top = d.body.scrollTop;
			<!-- /react-text --><span class="hljs-keyword" data-reactid="73">if</span><!-- react-text: 74 -->(top &gt; to){
				top -= <!-- /react-text --><span class="hljs-number" data-reactid="75">130</span><!-- react-text: 76 -->;
				<!-- /react-text --><span class="hljs-keyword" data-reactid="77">if</span><!-- react-text: 78 -->(top &lt; to){
					d.body.scrollTop = to;
					<!-- /react-text --><span class="hljs-keyword" data-reactid="79">return</span><!-- react-text: 80 -->;
				}
				d.body.scrollTop = top;
				animate(<!-- /react-text --><span class="hljs-built_in" data-reactid="81">arguments</span><!-- react-text: 82 -->.callee);
			}
			<!-- /react-text --><span class="hljs-keyword" data-reactid="83">else</span><!-- react-text: 84 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="85">if</span><!-- react-text: 86 -->(top &lt; to){
				<!-- /react-text --><span class="hljs-keyword" data-reactid="87">if</span><!-- react-text: 88 -->(top==max){
					d.body.scrollTop = to;
					<!-- /react-text --><span class="hljs-keyword" data-reactid="89">return</span><!-- react-text: 90 -->;
				}
				top += <!-- /react-text --><span class="hljs-number" data-reactid="91">130</span><!-- react-text: 92 -->;
				<!-- /react-text --><span class="hljs-keyword" data-reactid="93">if</span><!-- react-text: 94 -->(top &gt; to){
					d.body.scrollTop = to;
					<!-- /react-text --><span class="hljs-keyword" data-reactid="95">return</span><!-- react-text: 96 -->;
				}
				d.body.scrollTop = top;
				animate(<!-- /react-text --><span class="hljs-built_in" data-reactid="97">arguments</span><!-- react-text: 98 -->.callee);
			}	
		}
		animate(scrollToLink);
	})
};<!-- /react-text --></code></pre><p data-reactid="99">经过这个小Demo，我发现一个小知识点</p><blockquote data-reactid="100"><p data-reactid="101"><strong data-reactid="102"><em data-reactid="103">元素的offsetTop对相对于其设置了position属性的祖宗元素（若无则为body）。</em></strong></p></blockquote><p data-reactid="104">不信？！请看下面的测试</p><h1 id="我是第一！" data-reactid="105"><a href="#%E6%88%91%E6%98%AF%E7%AC%AC%E4%B8%80%EF%BC%81" aria-hidden="true" data-reactid="106"><span class="icon icon-link" data-reactid="107"></span></a><!-- react-text: 108 -->我是第一！<!-- /react-text --></h1><div style="position:relative;height:700px;border:2px dotted #00f;" data-reactid="109"><p data-reactid="110">第一的内容！ `position:relative; height:700px; `</p><div data-reactid="111"><script data-reactid="112">function alertAttr(t,r){alert(t[r])}</script><button data-reactid="113">点击看我的offsetTop</button></div><p data-reactid="114"></p></div><h1 id="我是第二！" data-reactid="115"><a href="#%E6%88%91%E6%98%AF%E7%AC%AC%E4%BA%8C%EF%BC%81" aria-hidden="true" data-reactid="116"><span class="icon icon-link" data-reactid="117"></span></a><!-- react-text: 118 -->我是第二！<!-- /react-text --></h1><div style="height:800px;border:2px dotted red;" data-reactid="119"><p data-reactid="120">第二的内容！ ` height:800px; `</p><button data-reactid="121">点击看我的offsetTop</button></div><h1 id="我是第三！" data-reactid="122"><a href="#%E6%88%91%E6%98%AF%E7%AC%AC%E4%B8%89%EF%BC%81" aria-hidden="true" data-reactid="123"><span class="icon icon-link" data-reactid="124"></span></a><!-- react-text: 125 -->我是第三！<!-- /react-text --></h1><div style="height:500px;border:2px dotted green;" data-reactid="126"><p data-reactid="127">第三的内容！ ` height:500px; `</p></div><br data-reactid="128"/><!-- react-text: 129 -->&gt; 更多的细节还可以看元素的`offsetParent`属性<!-- /react-text --></article></div><div class="gitment-container" data-reactid="130"></div><div class="paginator" data-reactid="131"><a title="短暂的git捣鼓" class="prev" href="/instant-git-test" data-reactid="132">Prev</a><a title="一次百度前端实习生面试" class="next" href="/baidu-fe-interview-1" data-reactid="133">Next</a></div></div></main><footer data-reactid="134"><div class="copyright" data-reactid="135"><p data-reactid="136"><!-- react-text: 137 -->© 2017. Powered By <!-- /react-text --><a href="https://github.com/picidaejs/picidae" data-reactid="138">Picidae</a></p></div></footer></div>
</div>
<audio id="music" controls autoplay src="http://www.170mv.com/kw/other.web.ri01.sycdn.kuwo.cn/resource/n3/25/67/3891786006.mp3"></audio>
<script>
  !function () {
    var a = document.getElementById("music")
    a && (a.volume = 1)
  }()
</script>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>
