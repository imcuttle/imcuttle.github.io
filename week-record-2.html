<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title> 毕设周记二 - Grass </title>
    <link rel="stylesheet" href="/style.css">
    <style>
        #music {
            position: fixed;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
<div id="root">
    <div class="wrap" data-reactroot="" data-reactid="1" data-react-checksum="-801621122"><header data-reactid="2"><a class="logo-link" href="/" data-reactid="3"><img src="/favicon.png" data-reactid="4"/></a><ul class="nav nav-list" data-reactid="5"><li class="nav-list-item" data-reactid="6"><a class="nav-list-link" href="/posts/1" data-reactid="7">Posts</a></li></ul></header><main data-reactid="8"><div class="post" data-reactid="9"><article class="post-block" data-reactid="10"><h1 class="post-title" data-reactid="11">毕设周记二</h1><div class="post-info" data-reactid="12"><time datetime="2017-04-11T19:30:30+00:00" data-reactid="13">Apr 11, 2017 7:30 PM</time></div></article><div class="post-content" data-reactid="14"><article data-reactid="15"><style data-reactid="16">.transformer-react-render{border:1px dashed #959da5;border-radius:5px;display:block}.transformer-react-render-container&gt;pre{max-height:400px;transition:all .2s ease}.transformer-react-render-container&gt;pre.focused{max-height:none;box-shadow:0 0 6px rgba(0,0,0,.2)}</style><p data-reactid="17"><!-- react-text: 18 -->题目：刷脸签到系统<!-- /react-text --><br data-reactid="19"/><!-- react-text: 20 -->姓名：余聪<!-- /react-text --></p><p data-reactid="21">最近几周主要完成了web前端页面的开发，与后端接口的开发。</p><p data-reactid="22"><!-- react-text: 23 -->界面如下： 1. 学生签到 <!-- /react-text --><div data-reactid="24"><style data-reactid="25">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:1440px;max-height:1440pxpx;" data-reactid="26"><div class="medium-image-progressive-placeholder" style="padding-bottom:56.25%;" data-reactid="27"></div><div class="medium-image-progressive" data-reactid="28"><canvas data-reactid="29"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="30"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588485d5c5134.jpg" data-reactid="31"/><noscript data-reactid="32"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588485d5c5134.jpg" data-reactid="33"/></noscript></div></div></div><!-- react-text: 34 --> <!-- /react-text --><div data-reactid="35"><style data-reactid="36">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:1440px;max-height:1440pxpx;" data-reactid="37"><div class="medium-image-progressive-placeholder" style="padding-bottom:56.25%;" data-reactid="38"></div><div class="medium-image-progressive" data-reactid="39"><canvas data-reactid="40"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="41"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/58848618b06ff.jpg" data-reactid="42"/><noscript data-reactid="43"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/58848618b06ff.jpg" data-reactid="44"/></noscript></div></div></div></p><ol start="2" data-reactid="45"><li data-reactid="46"><p data-reactid="47"><!-- react-text: 48 -->人脸录入 <!-- /react-text --><div data-reactid="49"><style data-reactid="50">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:1345px;max-height:1345pxpx;" data-reactid="51"><div class="medium-image-progressive-placeholder" style="padding-bottom:53.605947955390334%;" data-reactid="52"></div><div class="medium-image-progressive" data-reactid="53"><canvas data-reactid="54"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="55"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/04/11/58ecc6f371fe7.jpg" data-reactid="56"/><noscript data-reactid="57"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/04/11/58ecc6f371fe7.jpg" data-reactid="58"/></noscript></div></div></div></p></li><li data-reactid="59"><p data-reactid="60"><!-- react-text: 61 -->关于 <!-- /react-text --><div data-reactid="62"><style data-reactid="63">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:1440px;max-height:1440pxpx;" data-reactid="64"><div class="medium-image-progressive-placeholder" style="padding-bottom:56.25%;" data-reactid="65"></div><div class="medium-image-progressive" data-reactid="66"><canvas data-reactid="67"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="68"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588486cf622d8.jpg" data-reactid="69"/><noscript data-reactid="70"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588486cf622d8.jpg" data-reactid="71"/></noscript></div></div></div></p></li><li data-reactid="72"><p data-reactid="73"><!-- react-text: 74 -->管理员入口 <!-- /react-text --><div data-reactid="75"><style data-reactid="76">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:1440px;max-height:1440pxpx;" data-reactid="77"><div class="medium-image-progressive-placeholder" style="padding-bottom:56.25%;" data-reactid="78"></div><div class="medium-image-progressive" data-reactid="79"><canvas data-reactid="80"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="81"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588486ef8446d.jpg" data-reactid="82"/><noscript data-reactid="83"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/588486ef8446d.jpg" data-reactid="84"/></noscript></div></div></div></p></li></ol><p data-reactid="85"><!-- react-text: 86 -->前后端架构如下图： <!-- /react-text --><div data-reactid="87"><style data-reactid="88">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:379px;max-height:379pxpx;" data-reactid="89"><div class="medium-image-progressive-placeholder" style="padding-bottom:57.78364116094987%;" data-reactid="90"></div><div class="medium-image-progressive" data-reactid="91"><canvas data-reactid="92"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="93"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/04/11/58ecc1672afba.jpg" data-reactid="94"/><noscript data-reactid="95"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/04/11/58ecc1672afba.jpg" data-reactid="96"/></noscript></div></div></div></p><div data-reactid="97"><style data-reactid="98">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:770px;max-height:770pxpx;" data-reactid="99"><div class="medium-image-progressive-placeholder" style="padding-bottom:52.07792207792208%;" data-reactid="100"></div><div class="medium-image-progressive" data-reactid="101"><canvas data-reactid="102"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="103"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/58848833b7414.jpg" data-reactid="104"/><noscript data-reactid="105"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/22/58848833b7414.jpg" data-reactid="106"/></noscript></div></div></div><h2 id="前端" data-reactid="107"><a href="#%E5%89%8D%E7%AB%AF" aria-hidden="true" data-reactid="108"><span class="icon icon-link" data-reactid="109"></span></a><!-- react-text: 110 -->前端<!-- /react-text --></h2><ol data-reactid="111"><li data-reactid="112"><p data-reactid="113"><!-- react-text: 114 -->前端采用SPA（ single page web application，单页web应用 ）架构。<!-- /react-text --><br data-reactid="115"/><!-- react-text: 116 -->SPA是加载单个HTML 页面并在用户与应用程序交互时动态更新该页面的Web应用程序。 浏览器一开始会加载必需的HTML、CSS和JavaScript，所有的操作都在这张页面上完成，都由 JavaScript 来控制。因此，对单页应用来说模块化的开发和设计显得相当重要。<!-- /react-text --></p></li><li data-reactid="117"><p data-reactid="118">使用主流 Webpack 构建，进行前端模块自动化管理。</p></li><li data-reactid="119"><p data-reactid="120"><!-- react-text: 121 -->使用Facebook提出的 React 框架进行 View 开发， 将 HTML DOM 进行上层抽象，提出 Virtual DOM 概念，一套理念，实现了Server render, Web UI, mobile UI 的统一。 Learn Once, Write Anywhere <!-- /react-text --><div data-reactid="122"><style data-reactid="123">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:623px;max-height:623pxpx;" data-reactid="124"><div class="medium-image-progressive-placeholder" style="padding-bottom:63.56340288924559%;" data-reactid="125"></div><div class="medium-image-progressive" data-reactid="126"><canvas data-reactid="127"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="128"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/23/5884d71e7ed1d.jpg" data-reactid="129"/><noscript data-reactid="130"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/23/5884d71e7ed1d.jpg" data-reactid="131"/></noscript></div></div></div></p></li><li data-reactid="132"><p data-reactid="133">使用 HTML5 的 getUserMedia 方法，调用计算机音频视频等硬件设备。为了安全问题，Chrome 只能在本地地址上调用该方法</p></li><li data-reactid="134"><p data-reactid="135">WebWorker: 利用 Web Worker 起一个进程代码，主要做的是输入图片数据，输出人脸的位置大小，就是 JavaScript 版的人脸检测，之所以起另一个线程，是因为对于视频的人脸检测，对于实时性要求也比较高，检测也比较耗时，为了效率考虑使用了Web Worker多进程。</p></li><li data-reactid="136"><p data-reactid="137">...</p></li></ol><h2 id="后端" data-reactid="138"><a href="#%E5%90%8E%E7%AB%AF" aria-hidden="true" data-reactid="139"><span class="icon icon-link" data-reactid="140"></span></a><!-- react-text: 141 -->后端<!-- /react-text --></h2><ol data-reactid="142"><li data-reactid="143">采用 nodeJs 作为后端，采用 JavaScript 脚本语言开发。 nodeJs 具有异步事件驱动、非阻塞（non-blocking）IO 特性，采用 Google 的 V8 引擎来执行代码。</li><li data-reactid="144"><!-- react-text: 145 -->isomorphic render（同构渲染）： 指的是前后端使用同一份代码。前端通过 Webpack 实现 CommonJs 的模块规范（Node亦是 CommonJs ）+ React 提出的 JSX ，使得 NodeJs 通过解析请求的 URL，适配 react-router 中的前端路由规则，得到 routing Props，还可以 dispatch(action) 同步或异步（一般是 isomorphic-fetch ），又或是直接读取数据，从而更新 store ，最后 nodeJs 通过 store 中的 state 渲染 JSX ，产生静态的 HTML，从而实现了前后端的同构渲染。<!-- /react-text --><div data-reactid="146"><style data-reactid="147">
.medium-image-progressive-container {
  position: relative;
  width: 100%;
  margin: 0 auto;
  margin-top: 43px;
  display: block;
}
.image-loaded.medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-transition: visibility 0s linear .5s,opacity .1s .4s;
  transition: visibility 0s linear .5s,opacity .1s .4s;
}
.image-loaded.medium-image-progressive .medium-image-origin {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-progressive:not(.image-loaded):not(.canvas-loaded) {
  background-color: rgba(0, 0, 0, 0.05);
}
.medium-image-progressive-container .medium-image-progressive {
  position: absolute;
  top:0;left:0;width:100%;height:100%;
  max-width: 100%;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.medium-image-progressive-container img, .medium-image-progressive-container canvas {
  margin: 0 auto;
}
.medium-image-progressive-container .canvas-loaded.medium-image-progressive:not(.image-loaded) canvas {
  visibility: visible;
  opacity: 1;
  -webkit-transition: visibility 0s linear 0s,opacity .4s 0s;
  transition: visibility 0s linear 0s,opacity .4s 0s;
}
.medium-image-progressive-container .medium-image-origin,
.medium-image-progressive-container .medium-image-progressive canvas {
  visibility: hidden;
  opacity: 0;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}
</style><div class="medium-image-progressive-container" style="max-width:640px;max-height:640pxpx;" data-reactid="148"><div class="medium-image-progressive-placeholder" style="padding-bottom:62.5%;" data-reactid="149"></div><div class="medium-image-progressive" data-reactid="150"><canvas data-reactid="151"></canvas><img class="medium-image-progress" src="false" style="display:none;" data-reactid="152"/><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/23/5884dc559b020.jpg" data-reactid="153"/><noscript data-reactid="154"><img class="medium-image-origin" src="https://ooo.0o0.ooo/2017/01/23/5884dc559b020.jpg" data-reactid="155"/></noscript></div></div></div></li><li data-reactid="156">Express（Node.js Web 应用程序框架），很方便的定义 restful api. 十分适合 spa 的架构</li><li data-reactid="157">...</li></ol><h2 id="文件结构" data-reactid="158"><a href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84" aria-hidden="true" data-reactid="159"><span class="icon icon-link" data-reactid="160"></span></a><!-- react-text: 161 -->文件结构<!-- /react-text --></h2><pre data-reactid="162"><code data-query="{}" data-lang="data-lang" data-reactid="163">app/ # 前端目录
├── App.js          # 父组件(Container)
├── common/         # 一些通用的资源或模块
├── components/     # 一些封装的组件
├── index.tpl.html  # html模板
├── main.js         # 入口文件
├── pages/          # 所有页面
├── reducers/       # 数据修改集合
├── router.js       # 路由定义
└── workers/        # WebWorker：用于前端页面的人脸检测，多线程

gp-njnu-photos-backend/ # 后端代码目录
├── cache.json          # 学生帐号和密码验证结果的缓存
├── cpptest/            # 一些c++ opencv测试的代码
├── data/               # 一些数据文件：级联分类器/预处理后的人脸/人脸特征数据/...
├── database/           # 数据库访问代码，主要是人脸录入表
├── index.js            # 入口
├── lib/                # 一些 library
├── opencv/             # node-opencv 
├── package.json        
├── pretreat/           # 预处理代码
├── provider.js         # 开发环境下的入口
├── readme.md           # 说明
├── routes/             # express路由定义
├── server.js           # http服务 入口
├── ssl/                # https 证书
└── test/               # 一些测试
</code></pre><h2 id="部分代码解读" data-reactid="164"><a href="#%E9%83%A8%E5%88%86%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB" aria-hidden="true" data-reactid="165"><span class="icon icon-link" data-reactid="166"></span></a><!-- react-text: 167 -->部分代码解读<!-- /react-text --></h2><h3 id="开发环境（热部署）脚本" data-reactid="168"><a href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%88%E7%83%AD%E9%83%A8%E7%BD%B2%EF%BC%89%E8%84%9A%E6%9C%AC" aria-hidden="true" data-reactid="169"><span class="icon icon-link" data-reactid="170"></span></a><!-- react-text: 171 -->开发环境（热部署）脚本<!-- /react-text --></h3><pre data-reactid="172"><code class="hljs language-javascript" data-query="{}" data-lang="javascript" data-reactid="173"><span class="hljs-comment" data-reactid="174">// gp-njnu-photos-backend/provider.js</span><!-- react-text: 175 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="176">// language: javascript</span><!-- react-text: 177 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="178">// env: node</span><!-- react-text: 179 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="180">// usage: (cd gp-njnu-photos-backend &amp;&amp; npm run dev:w)</span><!-- react-text: 181 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="182">var</span><!-- react-text: 183 --> cp = <!-- /react-text --><span class="hljs-built_in" data-reactid="184">require</span><!-- react-text: 185 -->(<!-- /react-text --><span class="hljs-string" data-reactid="186">&#x27;child_process&#x27;</span><!-- react-text: 187 -->)
<!-- /react-text --><span class="hljs-keyword" data-reactid="188">var</span><!-- react-text: 189 --> p = <!-- /react-text --><span class="hljs-built_in" data-reactid="190">require</span><!-- react-text: 191 -->(<!-- /react-text --><span class="hljs-string" data-reactid="192">&#x27;path&#x27;</span><!-- react-text: 193 -->)
<!-- /react-text --><span class="hljs-keyword" data-reactid="194">var</span><!-- react-text: 195 --> fs = <!-- /react-text --><span class="hljs-built_in" data-reactid="196">require</span><!-- react-text: 197 -->(<!-- /react-text --><span class="hljs-string" data-reactid="198">&#x27;fs&#x27;</span><!-- react-text: 199 -->)

<!-- /react-text --><span class="hljs-keyword" data-reactid="200">const</span><!-- react-text: 201 --> isDir = <!-- /react-text --><span class="hljs-function" data-reactid="202"><!-- react-text: 203 -->(<!-- /react-text --><span class="hljs-params" data-reactid="204">filepath</span><!-- react-text: 205 -->) =&gt;<!-- /react-text --></span><!-- react-text: 206 --> fs.statSync(filepath).isDirectory()

<!-- /react-text --><span class="hljs-comment" data-reactid="207">/* 去除掉 非文件夹，node_modules文件夹，`.`开头的文件夹 */</span><!-- react-text: 208 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="209">const</span><!-- react-text: 210 --> children = fs.readdirSync(__dirname).filter(<!-- /react-text --><span class="hljs-function" data-reactid="211"><span class="hljs-params" data-reactid="212">n</span><!-- react-text: 213 -->=&gt;<!-- /react-text --></span><!-- react-text: 214 -->n!=<!-- /react-text --><span class="hljs-string" data-reactid="215">&#x27;node_modules&#x27;</span><!-- react-text: 216 --> &amp;&amp; !n.startsWith(<!-- /react-text --><span class="hljs-string" data-reactid="217">&#x27;.&#x27;</span><!-- react-text: 218 -->) &amp;&amp; isDir(p.join(__dirname, n)));

[__dirname].concat(children).forEach(<!-- /react-text --><span class="hljs-function" data-reactid="219"><span class="hljs-params" data-reactid="220">dir</span><!-- react-text: 221 --> =&gt;<!-- /react-text --></span><!-- react-text: 222 --> fs.watch(dir, watchHandle))

<!-- /react-text --><span class="hljs-comment" data-reactid="223">/* 监听到文件被修改则触发 */</span><!-- react-text: 224 -->
<!-- /react-text --><span class="hljs-function" data-reactid="225"><span class="hljs-keyword" data-reactid="226">function</span><!-- react-text: 227 --> <!-- /react-text --><span class="hljs-title" data-reactid="228">watchHandle</span><!-- react-text: 229 --> (<!-- /react-text --><span class="hljs-params" data-reactid="230">type, filename</span><!-- react-text: 231 -->) <!-- /react-text --></span><!-- react-text: 232 -->{
    <!-- /react-text --><span class="hljs-comment" data-reactid="233">// 无视不是js文件和点开头命名的文件</span><!-- react-text: 234 -->
    <!-- /react-text --><span class="hljs-keyword" data-reactid="235">if</span><!-- react-text: 236 -->(filename.startsWith(<!-- /react-text --><span class="hljs-string" data-reactid="237">&#x27;.&#x27;</span><!-- react-text: 238 -->) || !filename.endsWith(<!-- /react-text --><span class="hljs-string" data-reactid="239">&quot;.js&quot;</span><!-- react-text: 240 -->)) {
        <!-- /react-text --><span class="hljs-keyword" data-reactid="241">return</span><!-- react-text: 242 -->;
    }

    <!-- /react-text --><span class="hljs-built_in" data-reactid="243">console</span><!-- react-text: 244 -->.log(type, filename);
    <!-- /react-text --><span class="hljs-comment" data-reactid="245">// 杀死内存中的服务器进程</span><!-- react-text: 246 -->
    serverProcess.kill(<!-- /react-text --><span class="hljs-string" data-reactid="247">&#x27;SIGINT&#x27;</span><!-- react-text: 248 -->);
    serverProcess = runServer();
}

<!-- /react-text --><span class="hljs-keyword" data-reactid="249">var</span><!-- react-text: 250 --> serverProcess = runServer();
<!-- /react-text --><span class="hljs-comment" data-reactid="251">/* fork index.js 进程 */</span><!-- react-text: 252 -->
<!-- /react-text --><span class="hljs-function" data-reactid="253"><span class="hljs-keyword" data-reactid="254">function</span><!-- react-text: 255 --> <!-- /react-text --><span class="hljs-title" data-reactid="256">runServer</span><!-- react-text: 257 -->(<!-- /react-text --><span class="hljs-params" data-reactid="258"></span><!-- react-text: 259 -->) <!-- /react-text --></span><!-- react-text: 260 -->{
    <!-- /react-text --><span class="hljs-keyword" data-reactid="261">return</span><!-- react-text: 262 --> cp.fork(<!-- /react-text --><span class="hljs-string" data-reactid="263">&#x27;./index.js&#x27;</span><!-- react-text: 264 -->, process.argv, {<!-- /react-text --><span class="hljs-attr" data-reactid="265">stdio</span><!-- react-text: 266 -->: [<!-- /react-text --><span class="hljs-number" data-reactid="267">0</span><!-- react-text: 268 -->, <!-- /react-text --><span class="hljs-number" data-reactid="269">1</span><!-- react-text: 270 -->, <!-- /react-text --><span class="hljs-number" data-reactid="271">2</span><!-- react-text: 272 -->, <!-- /react-text --><span class="hljs-string" data-reactid="273">&#x27;ipc&#x27;</span><!-- react-text: 274 -->]})
}<!-- /react-text --></code></pre><h3 id="服务器自动更新代码" data-reactid="275"><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E4%BB%A3%E7%A0%81" aria-hidden="true" data-reactid="276"><span class="icon icon-link" data-reactid="277"></span></a><!-- react-text: 278 -->服务器自动更新代码<!-- /react-text --></h3><ul data-reactid="279"><li data-reactid="280">服务器端</li></ul><pre data-reactid="281"><code class="hljs language-javascript" data-query="{}" data-lang="javascript" data-reactid="282"><span class="hljs-comment" data-reactid="283">// gp-njnu-photos-backend/routes/control.js</span><!-- react-text: 284 -->

<!-- /react-text --><span class="hljs-comment" data-reactid="285">/* 访问 /api/ctrl/pull 服务器执行 git pull，从 github 更新代码 */</span><!-- react-text: 286 -->
ctrl.all(<!-- /react-text --><span class="hljs-string" data-reactid="287">&#x27;/pull&#x27;</span><!-- react-text: 288 -->, (req, res) =&gt; {
    res.writeHead(<!-- /react-text --><span class="hljs-number" data-reactid="289">200</span><!-- react-text: 290 -->, {
        <!-- /react-text --><span class="hljs-string" data-reactid="291">&#x27;Content-Type&#x27;</span><!-- react-text: 292 -->: <!-- /react-text --><span class="hljs-string" data-reactid="293">&#x27;text/event-stream&#x27;</span><!-- react-text: 294 -->,
        <!-- /react-text --><span class="hljs-string" data-reactid="295">&#x27;Cache-Control&#x27;</span><!-- react-text: 296 -->: <!-- /react-text --><span class="hljs-string" data-reactid="297">&#x27;no-cache&#x27;</span><!-- react-text: 298 -->,
        <!-- /react-text --><span class="hljs-string" data-reactid="299">&#x27;Connection&#x27;</span><!-- react-text: 300 -->: <!-- /react-text --><span class="hljs-string" data-reactid="301">&#x27;keep-alive&#x27;</span><!-- react-text: 302 -->
    });
    <!-- /react-text --><span class="hljs-keyword" data-reactid="303">var</span><!-- react-text: 304 --> ls = <!-- /react-text --><span class="hljs-built_in" data-reactid="305">require</span><!-- react-text: 306 -->(<!-- /react-text --><span class="hljs-string" data-reactid="307">&#x27;child_process&#x27;</span><!-- react-text: 308 -->).spawn(<!-- /react-text --><span class="hljs-string" data-reactid="309">&#x27;git&#x27;</span><!-- react-text: 310 -->, [<!-- /react-text --><span class="hljs-string" data-reactid="311">&#x27;pull&#x27;</span><!-- react-text: 312 -->, <!-- /react-text --><span class="hljs-string" data-reactid="313">&#x27;origin&#x27;</span><!-- react-text: 314 -->, <!-- /react-text --><span class="hljs-string" data-reactid="315">&#x27;master&#x27;</span><!-- react-text: 316 -->])
    ls.stdout.on(<!-- /react-text --><span class="hljs-string" data-reactid="317">&#x27;data&#x27;</span><!-- react-text: 318 -->, (data) =&gt; {
        data = data.toString()
        <!-- /react-text --><span class="hljs-built_in" data-reactid="319">console</span><!-- react-text: 320 -->.log(data)
        res.write(<!-- /react-text --><span class="hljs-string" data-reactid="321"><!-- react-text: 322 -->`<!-- /react-text --><span class="hljs-subst" data-reactid="323">${data}</span><!-- react-text: 324 -->`<!-- /react-text --></span><!-- react-text: 325 -->);
    });

    ls.stderr.on(<!-- /react-text --><span class="hljs-string" data-reactid="326">&#x27;data&#x27;</span><!-- react-text: 327 -->, (data) =&gt; {
        data = data.toString()
        <!-- /react-text --><span class="hljs-built_in" data-reactid="328">console</span><!-- react-text: 329 -->.log(data)
        res.write(<!-- /react-text --><span class="hljs-string" data-reactid="330"><!-- react-text: 331 -->`<!-- /react-text --><span class="hljs-subst" data-reactid="332">${data}</span><!-- react-text: 333 -->`<!-- /react-text --></span><!-- react-text: 334 -->);
    });
    ls.on(<!-- /react-text --><span class="hljs-string" data-reactid="335">&#x27;close&#x27;</span><!-- react-text: 336 -->, (code) =&gt; {
        <!-- /react-text --><span class="hljs-built_in" data-reactid="337">console</span><!-- react-text: 338 -->.log(<!-- /react-text --><span class="hljs-string" data-reactid="339"><!-- react-text: 340 -->`child process exited with code <!-- /react-text --><span class="hljs-subst" data-reactid="341">${code}</span><!-- react-text: 342 -->`<!-- /react-text --></span><!-- react-text: 343 -->)
        res.end(<!-- /react-text --><span class="hljs-string" data-reactid="344"><!-- react-text: 345 -->`child process exited with code <!-- /react-text --><span class="hljs-subst" data-reactid="346">${code}</span><!-- react-text: 347 -->`<!-- /react-text --></span><!-- react-text: 348 -->);
    });

})<!-- /react-text --></code></pre><ul data-reactid="349"><li data-reactid="350">本机（开发机）</li></ul><pre data-reactid="351"><code class="hljs language-javascript" data-query="{}" data-lang="javascript" data-reactid="352"><span class="hljs-meta" data-reactid="353">#!/bin/bash</span><!-- react-text: 354 -->

msg=<!-- /react-text --><span class="hljs-string" data-reactid="355">&quot;from bash&quot;</span><!-- react-text: 356 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="357">if</span><!-- react-text: 358 --> [ -n <!-- /react-text --><span class="hljs-string" data-reactid="359">&quot;$1&quot;</span><!-- react-text: 360 --> ]; then
    msg=$<!-- /react-text --><span class="hljs-number" data-reactid="361">1</span><!-- react-text: 362 -->
    # 重新 build 前端代码
    (cd gp-njnu-photos-app &amp;&amp; npm run build)
fi

git add .
git commit -m <!-- /react-text --><span class="hljs-string" data-reactid="363">&quot;$msg&quot;</span><!-- react-text: 364 -->
git push

# 如果push成功（exitcode=<!-- /react-text --><span class="hljs-number" data-reactid="365">0</span><!-- react-text: 366 -->），则访问远端 /api/ctrl/pull，从而服务器也更新了代码
<!-- /react-text --><span class="hljs-keyword" data-reactid="367">if</span><!-- react-text: 368 --> [ $? = <!-- /react-text --><span class="hljs-number" data-reactid="369">0</span><!-- react-text: 370 --> ]; then
    curl https:<!-- /react-text --><span class="hljs-comment" data-reactid="371">//face.moyuyc.xyz/api/ctrl/pull</span><!-- react-text: 372 -->
fi<!-- /react-text --></code></pre></article></div><div class="gitment-container" data-reactid="373"></div><div class="paginator" data-reactid="374"><a title="毕设周记三" class="prev" href="/graduation-weekly-record-3" data-reactid="375">Prev</a><a title="和手动刷新说拜拜" class="next" href="/say-goodbye-to-manual-refresh" data-reactid="376">Next</a></div></div></main><footer data-reactid="377"><div class="copyright" data-reactid="378"><p data-reactid="379"><!-- react-text: 380 -->© 2017. Powered By <!-- /react-text --><a href="https://github.com/picidaejs/picidae" data-reactid="381">Picidae</a></p></div></footer></div>
</div>
<audio id="music" controls autoplay src="http://www.170mv.com/kw/other.web.ri01.sycdn.kuwo.cn/resource/n3/25/67/3891786006.mp3"></audio>
<script>
  !function () {
    var a = document.getElementById("music")
    a && (a.volume = 1)
  }()
</script>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>
