<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title> JavaScript正则填坑记 - Grass </title>
    <link rel="stylesheet" href="/style.css">
    <style>
        #music {
            position: fixed;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
<div id="root">
    <div class="wrap" data-reactroot="" data-reactid="1" data-react-checksum="330792800"><header data-reactid="2"><a class="logo-link" href="/" data-reactid="3"><img src="/favicon.png" data-reactid="4"/></a><ul class="nav nav-list" data-reactid="5"><li class="nav-list-item" data-reactid="6"><a class="nav-list-link" href="/posts/1" data-reactid="7">Posts</a></li></ul></header><main data-reactid="8"><div class="post" data-reactid="9"><article class="post-block" data-reactid="10"><h1 class="post-title" data-reactid="11">JavaScript正则填坑记</h1><div class="post-info" data-reactid="12"><time datetime="2017-01-12T18:43:02+00:00" data-reactid="13">Jan 12, 2017 6:43 PM</time></div></article><div class="post-content" data-reactid="14"><article data-reactid="15"><style data-reactid="16">.transformer-react-render{border:1px dashed #959da5;border-radius:5px;display:block}.transformer-react-render-container&gt;pre{max-height:400px;transition:all .2s ease}.transformer-react-render-container&gt;pre.focused{max-height:none;box-shadow:0 0 6px rgba(0,0,0,.2)}</style><h2 id="问题重现" data-reactid="17"><a href="#%E9%97%AE%E9%A2%98%E9%87%8D%E7%8E%B0" aria-hidden="true" data-reactid="18"><span class="icon icon-link" data-reactid="19"></span></a><!-- react-text: 20 -->问题重现<!-- /react-text --></h2><p data-reactid="21"><!-- react-text: 22 -->不知道各位旁友在<!-- /react-text --><code data-reactid="23">webpack</code><!-- react-text: 24 -->的使用中，有没有碰到下面的问题情景： 1. 在使用了<!-- /react-text --><code data-reactid="25">css Module</code><!-- react-text: 26 -->的情况下，同时又希望用一些<!-- /react-text --><code data-reactid="27">global</code><!-- react-text: 28 -->的布局，其实在<!-- /react-text --><code data-reactid="29">css Module</code><!-- react-text: 30 -->中直接用<!-- /react-text --></p><pre data-reactid="31"><code data-query="{}" data-lang="data-lang" data-reactid="32">:global(.title) {
    color: green;
}
</code></pre><p data-reactid="33"><!-- react-text: 34 -->也是可以实现的，但是如果需要引入第三方css，如<!-- /react-text --><code data-reactid="35">Animate.css</code><!-- react-text: 36 -->，如果对每一个<!-- /react-text --><code data-reactid="37">classname</code><!-- react-text: 38 -->都进行手动的全局定义，工作量可不小。<!-- /react-text --></p><ol start="2" data-reactid="39"><li data-reactid="40"><!-- react-text: 41 -->关于<!-- /react-text --><code data-reactid="42">css</code><!-- react-text: 43 -->的打包问题，对于一些组件的样式，可以将<!-- /react-text --><code data-reactid="44">css</code><!-- react-text: 45 -->打包在<!-- /react-text --><code data-reactid="46">js</code><!-- react-text: 47 -->文件中，但是一些全局的<!-- /react-text --><code data-reactid="48">css</code><!-- react-text: 49 -->，或者一些需要第一时间加载的<!-- /react-text --><code data-reactid="50">css</code><!-- react-text: 51 --> (如<!-- /react-text --><code data-reactid="52">pace.css</code><!-- react-text: 53 -->，在页面加载过程中就需要第一时间解析出样式)，就需要使用<!-- /react-text --><code data-reactid="54">ExtractTextPlugin</code><!-- react-text: 55 -->打包成为单独的<!-- /react-text --><code data-reactid="56">css</code><!-- react-text: 57 -->文件了。<!-- /react-text --></li></ol><p data-reactid="58"><!-- react-text: 59 -->以上都是需要对于同一类型文件的不同处理。在<!-- /react-text --><code data-reactid="60">webpack</code><!-- react-text: 61 -->中就体现成用正则表达式进行文件名匹配。<!-- /react-text --></p><p data-reactid="62"><!-- react-text: 63 -->为了更优雅的命名，第一种情景来举例，我将全局的样式文件命名成<!-- /react-text --><code data-reactid="64">foo.global.less</code><!-- react-text: 65 -->，其他需要进行<!-- /react-text --><code data-reactid="66">css module</code><!-- react-text: 67 -->处理的则正常命名，如<!-- /react-text --><code data-reactid="68">bar.less</code><!-- react-text: 69 -->。<!-- /react-text --></p><h2 id="思路" data-reactid="70"><a href="#%E6%80%9D%E8%B7%AF" aria-hidden="true" data-reactid="71"><span class="icon icon-link" data-reactid="72"></span></a><!-- react-text: 73 -->思路<!-- /react-text --></h2><p data-reactid="74"><!-- react-text: 75 -->在进入主题之前，我先分享一个实用的在线正则网站<!-- /react-text --><a href="http://refiddle.com/" data-reactid="76">refiddle</a><!-- react-text: 77 -->，包含了不仅仅<!-- /react-text --><code data-reactid="78">Javascript</code><!-- react-text: 79 -->的正则<!-- /react-text --></p><p data-reactid="80"><!-- react-text: 81 -->下面的重头戏便是<!-- /react-text --><br data-reactid="82"/><strong data-reactid="83"><!-- react-text: 84 -->如何正则匹配<!-- /react-text --><code data-reactid="85">*.global.less</code><!-- react-text: 86 -->和<!-- /react-text --><code data-reactid="87">*.less</code><!-- react-text: 88 -->(不包括<!-- /react-text --><code data-reactid="89">*.global.less</code><!-- react-text: 90 -->)？<!-- /react-text --></strong></p><p data-reactid="91"><!-- react-text: 92 -->众所周知，<!-- /react-text --><code data-reactid="93">webpack</code><!-- react-text: 94 -->中是不存在多次正则匹配的，所以需要分别使用2个正则表达式来解决上面两种字符串的匹配。<!-- /react-text --></p><p data-reactid="95"><code data-reactid="96">*.global.less</code><!-- react-text: 97 -->字符串匹配？恩, so easy，<!-- /react-text --><code data-reactid="98">/\.global\.less$/</code><!-- react-text: 99 -->, 那么<!-- /react-text --><code data-reactid="100">*.less</code><!-- react-text: 101 -->(不包括<!-- /react-text --><code data-reactid="102">*.global.less</code><!-- react-text: 103 -->)呢？<!-- /react-text --></p><p data-reactid="104"><!-- react-text: 105 -->显然，这就需要用到正则的位置匹配了(<!-- /react-text --><code data-reactid="106">(^\.global)</code><!-- react-text: 107 -->和<!-- /react-text --><code data-reactid="108">[^\.global]</code><!-- react-text: 109 -->都是不正确的)，匹配前面不是<!-- /react-text --><code data-reactid="110">.global</code><!-- react-text: 111 -->的的位置。<!-- /react-text --></p><table data-reactid="112"><thead data-reactid="113"><tr data-reactid="114"><th data-reactid="115">分类</th><th data-reactid="116">语法</th><th data-reactid="117">说明</th></tr></thead><tbody data-reactid="118"><tr data-reactid="119"><td data-reactid="120">捕获</td><td data-reactid="121"><code data-reactid="122">(exp)</code></td><td data-reactid="123">匹配exp,并捕获文本到自动命名的组里</td></tr><tr data-reactid="124"><td data-reactid="125">捕获</td><td data-reactid="126"><code data-reactid="127">(?&lt;name&gt;exp)</code></td><td data-reactid="128">匹配exp,并捕获文本到名称为name的组里，也可以写成(?&#x27;name&#x27;exp)</td></tr><tr data-reactid="129"><td data-reactid="130">捕获</td><td data-reactid="131"><code data-reactid="132">(?:exp)</code></td><td data-reactid="133">匹配exp,不捕获匹配的文本，也不给此分组分配组号</td></tr><tr data-reactid="134"><td data-reactid="135">位置匹配</td><td data-reactid="136"><code data-reactid="137">(?=exp)</code></td><td data-reactid="138">匹配exp前面的位置</td></tr><tr data-reactid="139"><td data-reactid="140">位置匹配</td><td data-reactid="141"><code data-reactid="142">(?&lt;=exp)</code></td><td data-reactid="143">匹配exp后面的位置</td></tr><tr data-reactid="144"><td data-reactid="145">位置匹配</td><td data-reactid="146"><code data-reactid="147">(?!exp)</code></td><td data-reactid="148">匹配后面跟的不是exp的位置</td></tr><tr data-reactid="149"><td data-reactid="150">位置匹配</td><td data-reactid="151"><code data-reactid="152">(?&lt;!exp)</code></td><td data-reactid="153">匹配前面不是exp的位置</td></tr><tr data-reactid="154"><td data-reactid="155">注释</td><td data-reactid="156"><code data-reactid="157">(?#comment)</code></td><td data-reactid="158">这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读</td></tr></tbody></table><p data-reactid="159"><!-- react-text: 160 -->如上表，很显然需要使用<!-- /react-text --><code data-reactid="161">(?&lt;!exp)</code><!-- react-text: 162 -->，所以正则表达式是<!-- /react-text --><code data-reactid="163">/(?&lt;!global)\.less$/</code><!-- react-text: 164 -->，完结撒花！<!-- /react-text --></p><p data-reactid="165"><!-- react-text: 166 -->但是！真的就这样可以了吗？？很不幸的是在js中并没有实现<!-- /react-text --><code data-reactid="167">(?&lt;=exp)</code><!-- react-text: 168 -->和<!-- /react-text --><code data-reactid="169">(?&lt;!exp)</code><!-- react-text: 170 -->的位置匹配。（可能是大家伙都没想到Js能走到今天这个地步，以为只是在浏览器上耍耍，数据验证没必要太复杂吧 ）<!-- /react-text --><br data-reactid="171"/><!-- react-text: 172 -->参看<!-- /react-text --><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp" data-reactid="173">RegExp</a><!-- react-text: 174 -->.<!-- /react-text --></p><p data-reactid="175"><!-- react-text: 176 -->经过一番查找和头脑风暴，最终得到了Js中不包含某子串的正则匹配<!-- /react-text --><br data-reactid="177"/><strong data-reactid="178"><code data-reactid="179">/^(.(?!\.global))+\.less$/</code></strong></p><p data-reactid="180"><code data-reactid="181">(?!\.global)</code><!-- react-text: 182 -->匹配的是后面不是<!-- /react-text --><code data-reactid="183">.global</code><!-- react-text: 184 -->的位置<!-- /react-text --><br data-reactid="185"/><code data-reactid="186">(.(?!\.global))+</code><!-- react-text: 187 -->匹配的就是若干个后面跟着不是<!-- /react-text --><code data-reactid="188">.global</code><!-- react-text: 189 -->的字符<!-- /react-text --><br data-reactid="190"/><code data-reactid="191">^</code><!-- react-text: 192 -->字符串首位置不能丢！，如果丢了，<!-- /react-text --><code data-reactid="193">/(.(?!\.global))+\.less$/</code><!-- react-text: 194 -->也能够匹配<!-- /react-text --><code data-reactid="195">foo.global.less</code><!-- react-text: 196 -->，因为从<!-- /react-text --><code data-reactid="197">foo</code><!-- react-text: 198 -->后面的<!-- /react-text --><code data-reactid="199">.</code><!-- react-text: 200 -->开始，后面跟着的就不是<!-- /react-text --><code data-reactid="201">.global</code><!-- react-text: 202 -->了。<!-- /react-text --></p><p data-reactid="203"><!-- react-text: 204 -->但是对于<!-- /react-text --><code data-reactid="205">.global.less</code><!-- react-text: 206 -->字符串，该正则也无能为力了。<!-- /react-text --></p><h2 id="参考" data-reactid="207"><a href="#%E5%8F%82%E8%80%83" aria-hidden="true" data-reactid="208"><span class="icon icon-link" data-reactid="209"></span></a><!-- react-text: 210 -->参考<!-- /react-text --></h2><ol data-reactid="211"><li data-reactid="212"><a href="http://deerchao.net/tutorials/regex/regex.htm" data-reactid="213">正则表达式30分钟入门教程</a></li><li data-reactid="214"><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp" data-reactid="215">JavaScript RegExp</a></li><li data-reactid="216"><a href="http://www.cnblogs.com/bvbook/archive/2010/11/03/1867775.html" data-reactid="217">正则表达式匹配“不包含某个字符串” (通俗易懂还有图！)</a></li></ol><p data-reactid="218"><strong data-reactid="219"><!-- react-text: 220 -->2018年05月15日更新： ES2018已经支持后行断言。<!-- /react-text --><a href="https://github.com/tc39/proposal-regexp-lookbehind" data-reactid="221">https://github.com/tc39/proposal-regexp-lookbehind</a></strong></p></article></div><div class="gitment-container" data-reactid="222"></div><div class="paginator" data-reactid="223"><a title="一些好玩或喜欢的东西" class="prev" href="/funny-something-summary" data-reactid="224">Prev</a><a title="利用Hook解决moka邮件通知" class="next" href="/moka-hooks" data-reactid="225">Next</a></div></div></main><footer data-reactid="226"><div class="copyright" data-reactid="227"><p data-reactid="228"><!-- react-text: 229 -->© 2017. Powered By <!-- /react-text --><a href="https://github.com/picidaejs/picidae" data-reactid="230">Picidae</a></p></div></footer></div>
</div>
<audio id="music" controls autoplay src="http://www.170mv.com/kw/other.web.ri01.sycdn.kuwo.cn/resource/n3/25/67/3891786006.mp3"></audio>
<script>
  !function () {
    var a = document.getElementById("music")
    a && (a.volume = 1)
  }()
</script>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>
