<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title> imCuttle </title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<div id="root">
    <div class="wrap" data-reactroot="" data-reactid="1" data-react-checksum="-1139528864"><header data-reactid="2"><a class="logo-link" href="/" data-reactid="3"><img src="/favicon.png" data-reactid="4"/></a><ul class="nav nav-list" data-reactid="5"><li class="nav-list-item" data-reactid="6"><a class="nav-list-link" href="/posts/1" data-reactid="7">Posts</a></li></ul></header><main data-reactid="8"><div class="post" data-reactid="9"><article class="post-block" data-reactid="10"><h1 class="post-title" data-reactid="11">requestAnimationFrame Vs setInterval</h1><div class="post-info" data-reactid="12"><time datetime="2016-04-23T11:52:58+00:00" data-reactid="13">Apr 23, 2016 11:52 AM</time></div></article><div class="post-content" data-reactid="14"><article data-reactid="15"><h1 id="介绍" data-reactid="16"><a href="#%E4%BB%8B%E7%BB%8D" aria-hidden="true" data-reactid="17"><span class="icon icon-link" data-reactid="18"></span></a><!-- react-text: 19 -->介绍<!-- /react-text --></h1><!-- react-text: 20 -->
<!-- /react-text --><p data-reactid="21">大家对setInterval一定不陌生，但可能不太了解requestAnimationFrame
requestAnimationFrame是HTML5新添的api，两者都能产生动画效果。</p><!-- react-text: 22 -->
<!-- /react-text --><h1 id="区别" data-reactid="23"><a href="#%E5%8C%BA%E5%88%AB" aria-hidden="true" data-reactid="24"><span class="icon icon-link" data-reactid="25"></span></a><!-- react-text: 26 -->区别<!-- /react-text --></h1><!-- react-text: 27 -->
<!-- /react-text --><p data-reactid="28"><!-- react-text: 29 -->requestAnimationFrame 参数只有一个参数，是用来循环调用的方法，
setInterval 有两个参数，第一个是方法，第二个是循环调用的时间。
<!-- /react-text --><strong data-reactid="30">但是，JavaScript是单线程的，也就是同一时间只能有一句JavaScript语句执行所以，setInterval的实现是通过事件驱动完成的，当时间到了之后，setInterval加入事件队列，等待JavaScript的青睐，所以这种计时是不准确的。</strong></p><!-- react-text: 31 -->
<!-- /react-text --><!-- react-text: 32 -->
<!-- /react-text --><h2 id="demo" data-reactid="33"><a href="#demo" aria-hidden="true" data-reactid="34"><span class="icon icon-link" data-reactid="35"></span></a><!-- react-text: 36 -->Demo<!-- /react-text --></h2><!-- react-text: 37 -->
<!-- /react-text --><script data-reactid="38">function progress(p){p.style.width=&#x27;0%&#x27;;p.innerText=&#x27;0%&#x27;;function run(){var w = parseInt(p.style.width);p.innerText = w +&#x27;%&#x27;;if(w==100) return;p.style.width = w+1+&#x27;%&#x27;;setTimeout(arguments.callee,15)}setTimeout(run,15);}</script><!-- react-text: 39 -->
<!-- /react-text --><p id="progress" style="width:0%;background-color:blue;color:white;" data-reactid="40">0</p><!-- react-text: 41 -->
<!-- /react-text --><button data-reactid="42">RUN</button><!-- react-text: 43 -->
<!-- /react-text --><script data-reactid="44">progress(document.querySelector(&#x27;#progress&#x27;));</script><!-- react-text: 45 -->
<!-- /react-text --><pre data-reactid="46"><code data-query="{}" data-lang="data-lang" data-reactid="47">function progress(p){
    p.style.width=&#x27;0%&#x27;;
    p.innerText=&#x27;0%&#x27;;
    function run(){
        var w = parseInt(p.style.width);
        p.innerText = w +&#x27;%&#x27;;
        if(w==100) return;
        p.style.width = w+1+&#x27;%&#x27;;
        requestAnimationFrame(arguments.callee)
    }
    requestAnimationFrame(run);
}
</code></pre><!-- react-text: 48 -->
<!-- /react-text --><script data-reactid="49">function progress2(p){p.style.width=&#x27;0%&#x27;;p.innerText=&#x27;0%&#x27;;function run(){var w = parseInt(p.style.width);p.innerText = w +&#x27;%&#x27;;if(w==100){clearInterval(t); return;}p.style.width = w+1+&#x27;%&#x27;;}var t =setInterval(run,15);}</script><!-- react-text: 50 -->
<!-- /react-text --><p id="progress2" style="width:0%;background-color:blue;color:white;" data-reactid="51">0</p><!-- react-text: 52 -->
<!-- /react-text --><button data-reactid="53">RUN</button><!-- react-text: 54 -->
<!-- /react-text --><script data-reactid="55">progress2(document.querySelector(&#x27;#progress2&#x27;));</script><!-- react-text: 56 -->
<!-- /react-text --><pre data-reactid="57"><code data-query="{}" data-lang="data-lang" data-reactid="58">function progress2(p){
    p.style.width=&#x27;0%&#x27;;
    p.innerText=&#x27;0%&#x27;;
    function run(){
        var w = parseInt(p.style.width);
        p.innerText = w +&#x27;%&#x27;;
        if(w==100){
            clearInterval(t); return;
        }
        p.style.width = w+1+&#x27;%&#x27;;
    }
    var t =setInterval(run,15);
}
</code></pre><!-- react-text: 59 -->
<!-- /react-text --><p data-reactid="60"><!-- react-text: 61 --> 可以看到，<!-- /react-text --><code data-reactid="62">requestAnimationFrame</code><!-- react-text: 63 -->代码量更少。<!-- /react-text --></p><!-- react-text: 64 -->
<!-- /react-text --><h1 id="惊天秘密" data-reactid="65"><a href="#%E6%83%8A%E5%A4%A9%E7%A7%98%E5%AF%86" aria-hidden="true" data-reactid="66"><span class="icon icon-link" data-reactid="67"></span></a><!-- react-text: 68 -->惊天秘密<!-- /react-text --></h1><!-- react-text: 69 -->
<!-- /react-text --><p data-reactid="70"><!-- react-text: 71 --> <!-- /react-text --><strong data-reactid="72"><!-- react-text: 73 -->深入理解，可以把<!-- /react-text --><code data-reactid="74">requestAnimationFrame(func)</code><!-- react-text: 75 -->等效为<!-- /react-text --><code data-reactid="76">setTimeout(func,15);</code></strong><!-- react-text: 77 -->
不信，你试下嘛。
当然，<!-- /react-text --><code data-reactid="78">requestAnimationFrame</code><!-- react-text: 79 -->在浏览器查看其它网页的一段时间后，便会自动停止动画。
在threejs中，就是用<!-- /react-text --><code data-reactid="80">requestAnimationFrame</code><!-- react-text: 81 -->来减少cpu负载的。
<!-- /react-text --><strong data-reactid="82">2016/5/15 更新</strong><!-- react-text: 83 -->
<!-- /react-text --><code data-reactid="84">requestAnimationFrame</code><!-- react-text: 85 --> 中会默认传入一个相对的时间戳，<!-- /react-text --><a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame" data-reactid="86">详细看这里</a><!-- react-text: 87 -->；
<!-- /react-text --><code data-reactid="88">setTimeout(func,15);</code><!-- react-text: 89 -->除了这种用法以外，还可以<!-- /react-text --><code data-reactid="90">setTimeout(func,15,args);</code><!-- react-text: 91 -->传入参数，当然<!-- /react-text --><code data-reactid="92">setInterval</code><!-- react-text: 93 -->也一样。
<!-- /react-text --></p><!-- react-text: 94 -->
<!-- /react-text --></article></div><div class="gitment-container" data-reactid="95"></div><div class="paginator" data-reactid="96"><a title="捣鼓出一个简陋的图片轮播效果" class="prev" href="/easy-img-viewer" data-reactid="97">Prev</a><a title="短暂的git捣鼓" class="next" href="/instant-git-test" data-reactid="98">Next</a></div></div></main><footer data-reactid="99"><div class="copyright" data-reactid="100"><p data-reactid="101"><!-- react-text: 102 -->© 2017. Powered By <!-- /react-text --><a href="https://github.com/picidaejs/picidae" data-reactid="103">Picidae</a></p></div></footer></div>
</div>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>