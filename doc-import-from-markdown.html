<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title> 导入markdown至树状文档 - Grass </title>
    <link rel="stylesheet" href="/style.css">
    <style>
        #music {
            position: fixed;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
<div id="root">
    <div class="wrap" data-reactroot="" data-reactid="1" data-react-checksum="1814952583"><header data-reactid="2"><a class="logo-link" href="/" data-reactid="3"><img src="/favicon.png" data-reactid="4"/></a><ul class="nav nav-list" data-reactid="5"><li class="nav-list-item" data-reactid="6"><a class="nav-list-link" href="/posts/1" data-reactid="7">Posts</a></li></ul></header><main data-reactid="8"><div class="post" data-reactid="9"><article class="post-block" data-reactid="10"><h1 class="post-title" data-reactid="11">导入markdown至树状文档</h1><div class="post-info" data-reactid="12"><time datetime="2017-08-20T22:04:05+00:00" data-reactid="13">Aug 20, 2017 10:04 PM</time></div></article><div class="post-content" data-reactid="14"><article data-reactid="15"><style data-reactid="16">.transformer-react-render{border:1px dashed #959da5;border-radius:5px;display:block}.transformer-react-render-container&gt;pre{max-height:400px;transition:all .2s ease}.transformer-react-render-container&gt;pre.focused{max-height:none;box-shadow:0 0 6px rgba(0,0,0,.2)}</style><h2 id="为什么有这个需求" data-reactid="17"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E8%BF%99%E4%B8%AA%E9%9C%80%E6%B1%82" aria-hidden="true" data-reactid="18"><span class="icon icon-link" data-reactid="19"></span></a><!-- react-text: 20 -->为什么有这个需求<!-- /react-text --></h2><ol data-reactid="21"><li data-reactid="22">个人习惯于书写原生的Markdown（纯粹的文本编辑）。不需要记各种快捷键。</li><li data-reactid="23">书写原始 markdown 文件方便进行个人博客文章的部署和备份。</li><li data-reactid="24">方便将文章发布至其他平台（GitHub/SF...）</li></ol><h2 id="如何使用" data-reactid="25"><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8" aria-hidden="true" data-reactid="26"><span class="icon icon-link" data-reactid="27"></span></a><!-- react-text: 28 -->如何使用<!-- /react-text --></h2><p data-reactid="29"><a href="https://github.com/imcuttle/doc-import-md" data-reactid="30">repo地址(doc-import-md)</a></p><ul data-reactid="31"><li data-reactid="32">cli</li></ul><pre data-reactid="33"><code class="hljs language-bash" data-query="{}" data-lang="bash" data-reactid="34"><!-- react-text: 35 -->npm i -g doc-import-md
docin -h
docin <!-- /react-text --><span class="hljs-built_in" data-reactid="36">set</span><!-- react-text: 37 -->-username &lt;your name&gt;
docin <!-- /react-text --><span class="hljs-built_in" data-reactid="38">set</span><!-- react-text: 39 -->-password

cat file/to/markdown | docin<!-- /react-text --></code></pre><ul data-reactid="40"><li data-reactid="41">package</li></ul><pre data-reactid="42"><code class="hljs language-js" data-query="{}" data-lang="js" data-reactid="43"><span class="hljs-keyword" data-reactid="44">var</span><!-- react-text: 45 --> DocImportMd = <!-- /react-text --><span class="hljs-built_in" data-reactid="46">require</span><!-- react-text: 47 -->(<!-- /react-text --><span class="hljs-string" data-reactid="48">&#x27;doc-import-md&#x27;</span><!-- react-text: 49 -->);
<!-- /react-text --><span class="hljs-keyword" data-reactid="50">var</span><!-- react-text: 51 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="52">import</span><!-- react-text: 53 --> = <!-- /react-text --><span class="hljs-keyword" data-reactid="54">new</span><!-- react-text: 55 --> DocImportMd(<!-- /react-text --><span class="hljs-string" data-reactid="56">&#x27;username&#x27;</span><!-- react-text: 57 -->, <!-- /react-text --><span class="hljs-string" data-reactid="58">&#x27;pwd&#x27;</span><!-- react-text: 59 -->, <!-- /react-text --><span class="hljs-string" data-reactid="60">&#x27;address&#x27;</span><!-- react-text: 61 -->)
<!-- /react-text --><span class="hljs-keyword" data-reactid="62">var</span><!-- react-text: 63 --> markdown = <!-- /react-text --><span class="hljs-string" data-reactid="64">&#x27;# H1\n ## hhh&#x27;</span><!-- react-text: 65 -->

<!-- /react-text --><span class="hljs-comment" data-reactid="66">// new an document &amp; push to server.</span><!-- react-text: 67 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="68">import</span><!-- react-text: 69 -->
    .new(markdown, <!-- /react-text --><span class="hljs-string" data-reactid="70">&#x27;title&#x27;</span><!-- react-text: 71 -->)
    .then(<!-- /react-text --><span class="hljs-function" data-reactid="72"><span class="hljs-keyword" data-reactid="73">function</span><!-- react-text: 74 --> (<!-- /react-text --><span class="hljs-params" data-reactid="75">listId</span><!-- react-text: 76 -->) <!-- /react-text --></span><!-- react-text: 77 -->{

    });

<!-- /react-text --><span class="hljs-comment" data-reactid="78">// insert document to document</span><!-- react-text: 79 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="80">// which is already existed</span><!-- react-text: 81 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="82">import</span><!-- react-text: 83 -->
    .insert(<!-- /react-text --><span class="hljs-string" data-reactid="84">&#x27;listId&#x27;</span><!-- react-text: 85 -->, markdown, <!-- /react-text --><span class="hljs-string" data-reactid="86">&#x27;parentId &lt;maybe is null&gt;&#x27;</span><!-- react-text: 87 -->).then(<!-- /react-text --><span class="hljs-function" data-reactid="88"><span class="hljs-keyword" data-reactid="89">function</span><!-- react-text: 90 --> (<!-- /react-text --><span class="hljs-params" data-reactid="91">data</span><!-- react-text: 92 -->) <!-- /react-text --></span><!-- react-text: 93 -->{
        <!-- /react-text --><span class="hljs-comment" data-reactid="94">// data.listId</span><!-- react-text: 95 -->
        <!-- /react-text --><span class="hljs-comment" data-reactid="96">// data.nodeId // maybe undefined</span><!-- react-text: 97 -->
    });<!-- /react-text --></code></pre><h2 id="实现思路" data-reactid="98"><a href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF" aria-hidden="true" data-reactid="99"><span class="icon icon-link" data-reactid="100"></span></a><!-- react-text: 101 -->实现思路<!-- /react-text --></h2><pre data-reactid="102"><code class="hljs language-markdown" data-query="{}" data-lang="markdown" data-reactid="103"><span class="hljs-section" data-reactid="104"># A               -&gt;  # A --- i&#x27;m an apple.</span><!-- react-text: 105 -->
i&#x27;m an apple.             |-- i&#x27;m an egg.
i&#x27;m an egg.               |-- &gt; <!-- /react-text --><span class="hljs-code" data-reactid="106">```
&gt; ```                     |   &gt; code A
&gt; code A                  |   &gt; ``` 
&gt; ```                     \-- ## A-1 --- text in A-1 
                                     |-- 1. A-1-1
## A-1                               |      |-- description1 in A-1-1 
                                     |      \-- description2 in A-1-1
text in A-1                          |-- 2. A-1-2
                                     |-- 3. A-1-3
1. A-1-1                             |-- not description 
description1 in A-1-1                \-- ~~~\ncode\n~~~
description2 in A-1-1
2. A-1-2

3. A-1-3


not description

~~~
code B
~~~</span></code></pre><p data-reactid="107">上面为 markdown 的输入和需要输出的中间数据结构。</p><ol data-reactid="108"><li data-reactid="109"><p data-reactid="110"><!-- react-text: 111 -->#难点 解析 Markdown 文本（借助亮亮的 <!-- /react-text --><a href="https://github.com/imcuttle/doc-import-md/blob/master/lib/TokenParser.js" data-reactid="112">TokenParserV2</a><!-- react-text: 113 -->设计）得到<!-- /react-text --><a href="https://github.com/imcuttle/doc-import-md/blob/master/lib/parser-factory/md-to-tree.js" data-reactid="114">树形数据结构</a><!-- react-text: 115 -->。<!-- /react-text --></p></li><li data-reactid="116"><p data-reactid="117"><!-- react-text: 118 -->分析 doc.eux 的传参规则. <!-- /react-text --><a href="https://github.com/imcuttle/doc-import-md/blob/master/lib/actions.js" data-reactid="119">code</a></p></li><li data-reactid="120"><p data-reactid="121"><!-- react-text: 122 -->进行 登录 -&gt; 新建文章 -&gt; 修改文章名 -&gt; 添加内容节点. <!-- /react-text --><a href="https://github.com/imcuttle/doc-import-md/blob/master/index.js" data-reactid="123">code</a></p></li></ol><h2 id="todo" data-reactid="124"><a href="#todo" aria-hidden="true" data-reactid="125"><span class="icon icon-link" data-reactid="126"></span></a><!-- react-text: 127 -->Todo<!-- /react-text --></h2><ul data-reactid="128"><li data-reactid="129"><p data-reactid="130"><!-- react-text: 131 -->加入 <!-- /react-text --><code data-reactid="132">doc -&gt; md</code><!-- react-text: 133 --> 的方向，与 <!-- /react-text --><code data-reactid="134">md -&gt; doc</code><!-- react-text: 135 --> 互逆<!-- /react-text --></p></li><li data-reactid="136"><p data-reactid="137">同构 request 实现 浏览器端的支持</p></li><li data-reactid="138"><p data-reactid="139"><!-- react-text: 140 -->考虑后续加入项目配置 <!-- /react-text --><code data-reactid="141">.docinrc</code></p><pre data-reactid="142"><code class="hljs language-js" data-query="{}" data-lang="js" data-reactid="143"><span class="hljs-comment" data-reactid="144">// 后续提交 `docRoot` 下的`*.md` 文件</span><!-- react-text: 145 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="146">// git可以自动同步至doc</span><!-- react-text: 147 -->
{
    <!-- /react-text --><span class="hljs-string" data-reactid="148">&quot;docRoot&quot;</span><!-- react-text: 149 -->: <!-- /react-text --><span class="hljs-string" data-reactid="150">&quot;./doc&quot;</span><!-- react-text: 151 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="152">&quot;docAddress&quot;</span><!-- react-text: 153 -->: <!-- /react-text --><span class="hljs-string" data-reactid="154">&quot;....&quot;</span><!-- react-text: 155 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="156">&quot;user&quot;</span><!-- react-text: 157 -->: {...}
}<!-- /react-text --></code></pre></li></ul></article></div><div class="gitment-container" data-reactid="158"></div><div class="paginator" data-reactid="159"><a title="markdown导入doc核心算法剖析" class="prev" href="/the-core-algorithm-of-doc-md-import" data-reactid="160">Prev</a><a title="组件库Demo页发布自动化" class="next" href="/deploy-demo-page-automatically" data-reactid="161">Next</a></div></div></main><footer data-reactid="162"><div class="copyright" data-reactid="163"><p data-reactid="164"><!-- react-text: 165 -->© 2017. Powered By <!-- /react-text --><a href="https://github.com/picidaejs/picidae" data-reactid="166">Picidae</a></p></div></footer></div>
</div>
<audio id="music" controls autoplay src="http://www.170mv.com/kw/other.web.ri01.sycdn.kuwo.cn/resource/n3/25/67/3891786006.mp3"></audio>
<script>
  !function () {
    var a = document.getElementById("music")
    a && (a.volume = 1)
  }()
</script>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>
